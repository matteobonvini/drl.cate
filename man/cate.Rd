% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cate.R
\name{cate}
\alias{cate}
\title{CATE}
\usage{
cate(
  data,
  learner,
  x_names,
  y_name,
  a_name,
  v_names,
  v0,
  mu1.x,
  mu0.x,
  pi.x,
  drl.v,
  drl.x,
  nsplits = 5,
  foldid = NULL,
  univariate_reg = FALSE,
  partial_dependence = FALSE,
  partially_linear = FALSE,
  additive_approx = FALSE,
  vimp_num_splits = 1,
  bw.stage2 = NULL,
  sample.split.cond.dens = FALSE,
  cond.dens = NULL,
  cate.w = NULL,
  cate.not.j = NULL,
  reg.basis.not.j = NULL,
  pl.dfs = NULL,
  fit.basis.additive = NULL
)
}
\arguments{
\item{data}{A data frame containing the dataset.}

\item{learner}{Character vector of learners to use (currently only \code{"dr"} is implemented).}

\item{x_names}{Character vector with the names of confounding variables \(X\).}

\item{y_name}{Character string: outcome variable name \(Y\).}

\item{a_name}{Character string: treatment variable name \(A\).}

\item{v_names}{Character vector with the names of the effect modifiers \(V\).}

\item{v0}{Matrix of evaluation points; rows are values of \(V\) at which the CATE
\eqn{E(Y^1 - Y^0 | V=v_0)} is estimated.}

\item{mu1.x}{Function \code{function(y, a, x, new.x)} that trains a model for
\eqn{E[Y | A=1, X]} and returns a list with elements \emph{res} (predictions at \code{new.x}),
\emph{model} (fitted model object), and \emph{fit} (predictor function of \code{new.x}).}

\item{mu0.x}{Function \code{function(y, a, x, new.x)} that trains a model for
\eqn{E[Y | A=0, X]} and returns a list with elements \emph{res}, \emph{model}, and \emph{fit}.}

\item{pi.x}{Function \code{function(a, x, new.x)} that trains a model for the propensity
\eqn{P(A=1 | X)} and returns a list with elements \emph{res}, \emph{model}, and \emph{fit}.}

\item{drl.v}{Function \code{function(pseudo, v, new.v)} that regresses the pseudo-outcome on \(V\)
to estimate \eqn{E(Y^1 - Y^0 | V)}, returning \emph{res}, \emph{model}, and \emph{fit}.}

\item{drl.x}{Function \code{function(pseudo, x, new.x)} that regresses the pseudo-outcome on \(X\)
to estimate \eqn{E(Y^1 - Y^0 | X)}, returning \emph{res}, \emph{model}, and \emph{fit}.}

\item{nsplits}{Integer; number of splits used for cross-validation (ignored if \code{foldid} is given).}

\item{foldid}{Optional integer vector of fold assignments.}

\item{univariate_reg}{Logical; if \code{TRUE}, perform univariate regression of the CATE on each
effect modifier separately. Default \code{FALSE}.}

\item{partial_dependence}{Logical; if \code{TRUE}, compute partial-dependence estimates. Default \code{FALSE}.}

\item{partially_linear}{Logical; if \code{TRUE}, compute partially linear approximations via Robinson's transformation.
Default \code{FALSE}.}

\item{additive_approx}{Logical; if \code{TRUE}, compute an additive approximation to the CATE. Default \code{FALSE}.}

\item{vimp_num_splits}{Integer; number of splits for variable-importance computation. Default \code{1}.}

\item{bw.stage2}{List of length equal to \code{length(v_names)}; each element is a vector of candidate
bandwidths for second-stage regression used in univariate CATE or partial-dependence estimation. Required when
\code{univariate_reg} or \code{partial_dependence} is \code{TRUE}. Default \code{NULL}.}

\item{sample.split.cond.dens}{Logical; if \code{TRUE}, use sample-splitting for conditional-density estimation.
Default \code{FALSE}.}

\item{cond.dens}{List of functions for conditional-density estimation, one per effect modifier \eqn{V_j}.
Each should return an object with a method \code{predict.cond.dens(new.v1, new.v2)}. Default \code{NULL}.}

\item{cate.w}{List of functions \code{function(tau, w, new.w)} (one per effect modifier) that fit \eqn{E[tau | W]}
and return an object with a \code{fit(new.w)} method. Default \code{NULL}.}

\item{cate.not.j}{List of functions (one per \(j\)) used in the partially linear Robinson step for \eqn{V_{-j}}. Default \code{NULL}.}

\item{reg.basis.not.j}{List of basis/estimation helpers for the \eqn{V_{-j}} regression in the Robinson step. Default \code{NULL}.}

\item{pl.dfs}{List (length \code{length(v_names)}) where each element is a vector of candidate degrees of freedom
for the partially linear approximation. Default \code{NULL}.}

\item{fit.basis.additive}{Optional function used to fit the additive model (GAM); if \code{NULL} and
\code{additive_approx=TRUE}, \code{drl.additive.basis()} is used. Default \code{NULL}.}
}
\value{
A list with elements for V-based and X-based CATE results, per-fold estimates, pseudo-outcomes,
univariate/partial-dependence/additive/Robinson outputs, variable-importance results, and inputs used.
}
\description{
Estimate heterogeneous treatment effects (HTEs) defined as \(E(Y^1 - Y^0 | V = v_0)\).
}
\references{
Kennedy, E. H. (2020). Optimal Doubly Robust Estimation of Heterogeneous Causal Effects.
\emph{arXiv preprint} arXiv:2004.14497.
}
